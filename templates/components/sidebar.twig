<div class="z-40 fixed bg-white dark:bg-[#292827] top-0 left-0 border-r border-gray-400 w-62 h-screen mt-10 pt-10 sm:translate-x-0 transition-transform {{ isSideBar ? 'translate-x-0' : '-translate-x-full' }}">
  <ul class="dark:text-gray-200 mx-4 text-gray-800 text-lg font-bold flex flex-col gap-4">
    {% set menu = [
      { item: 'Dashboard', icon: '<i class="fa-solid fa-gear"></i>', link: '/dashboard.php' },
      { item: 'Ticket', icon: 'ticket', link: '/ticketPage.php' },
      { item: 'Settings', icon: 'settings', link: '/settings.php' }
    ] %}

    {% for list in menu %}
      <a href="{{ list.link }}">
        <li class="p-2 rounded-lg flex gap-2 items-center transition-colors
          {{ currentPath == list.link ? 'bg-orange-100 text-orange-600 dark:bg-orange-900/50 dark:text-orange-200' : 'hover:bg-gray-100 dark:hover:bg-gray-700/50 dark:hover:text-gray-200' }}">
          <i class="icon-{{ list.icon }}"></i> {{ list.item }}
        </li>
      </a>
    {% endfor %}
  </ul>

  {% if session.user %}
    <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-[#292827]">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900 flex items-center justify-center text-orange-600 dark:text-orange-200 font-semibold">
          {{ session.user.name[0]|upper }}
        </div>
        <div class="flex flex-col">
          <span class="text-sm font-semibold dark:text-gray-200">{{ session.user.name }}</span>
          <span class="text-xs text-gray-500 dark:text-gray-400">{{ session.user.email }}</span>
        </div>
      </div>

      <form method="POST" action="/logout">
        <button class="flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg w-full">
          <i class="icon-logout text-gray-500"></i> <span>Logout</span>
        </button>
      </form>

      <div class="text-xs text-gray-400 dark:text-gray-500">
        Session expires: {{ session.expiresAt|date("H:i") }}
      </div>
    </div>
  {% endif %}
</div>



<script> 
    // Auth check
    const session = JSON.parse(localStorage.getItem('ticketapp_session'));
    if (!session) {
        showToast('Your session has expired â€” please log in again.');
        window.location.href = '/login.php';
    } else {
        document.getElementById('user-avatar').textContent = session.user.name.charAt(0).toUpperCase();
        document.getElementById('user-name').textContent = session.user.name;
        document.getElementById('user-email').textContent = session.user.email;
        document.getElementById('session-expiry').textContent = `Session expires: ${new Date(session.expiresAt).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})}`;
    }

    let tickets = JSON.parse(localStorage.getItem('tickets') || '[]');
    </script>
